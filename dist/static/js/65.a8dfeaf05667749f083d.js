webpackJsonp([65],{409:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(92);t.default={data:function(){return{carNum:"",applyTime:"",memberRateId:"",payType:"",monthCardList:[],payTypeList:this.Util.payTypeList,totalMoney:0,array:[],changeCountArray:[],tableTitleList:[],currentPage:1,total:0,pageSize:10,listLoading:!1,chargeSumVisible:!1}},mounted:function(){this.getTableList(),this.listMemberRateSim()},beforeUpdate:function(){document.getElementById("menu-box-6").classList.add("menu-active")},methods:{exportExcel:function(){var e=this;a.e(0).then(function(){var t=a(361),r=t.export_json_to_excel,o=["车牌号","车主姓名","会员类型","业务类型","办理时长","缴纳金额(元)","缴纳方式","办理时间","管理员","生效时间","失效时间","备注"],n=["carNum","owner","memberType","operatorType","applyLen","payMoney","payType","payTime","operatorName","startTime","stopTime","remark"],i=e.Util.deepCopy(e.array);r(o,e.Util.formatJson(n,i),"会员收费明细")}.bind(null,a)).catch(a.oe)},listMemberRateSim:function(){var e=this;(0,r.listMemberRateSim)({operatorId:this.Util.userInfo.id}).then(function(t){console.log(t),t.data.data?e.monthCardList=t.data.data:e.$message.error(t.data.msg)})},handleSizeChange:function(e){this.pageSize=e,this.getTableList(!1)},handleCurrentChange:function(e){this.currentPage=e,this.getTableList(!1)},formatOperatorType:function(e,t){return 0==e.operatorType?"办理":1==e.operatorType?"续费":2==e.operatorType?"退还":3==e.operatorType?"补交":"未知"},indexMethod:function(e){return e+this.pageSize*(this.currentPage-1)+1},getTableList:function(e){var t=this,a={operatorId:this.Util.userInfo.id,applyLowTime:"",applyUpTime:"",carNum:this.carNum,memberRateId:this.memberRateId,payType:this.payType,current:this.currentPage-1,length:this.pageSize};e&&(a.current=0),this.applyTime&&(a.applyLowTime=this.Util.formatDate.format(this.applyTime[0],"yyyy-MM-dd hh:mm:ss"),a.applyUpTime=this.Util.formatDate.format(this.applyTime[1],"yyyy-MM-dd hh:mm:ss")),(0,r.changeList)(a).then(function(e){"SUCCESS"==e.data.code?(t.array=e.data.data.pageData.content,t.array.forEach(function(e){e.carNum=e.card.carNum,e.owner=e.card.owner,e.memberType=e.card.memberType,e.startTime=e.card.startTime,e.stopTime=e.card.stopTime,0==e.operatorType?e.operatorType="办理":1==e.operatorType?e.operatorType="续费":2==e.operatorType?e.operatorType="退还":3==e.operatorType?e.operatorType="补交":e.operatorType="未知"}),t.total=e.data.data.pageData.totalElements,t.totalMoney=e.data.data.totalMoney):t.$message.error(e.data.msg)})},openChangeCountDialog:function(){this.changeCount()},changeCount:function(){var e=this,t={operatorId:this.Util.userInfo.id,applyLowTime:"",applyUpTime:"",carNum:this.carNum,memberRateId:this.memberRateId,payType:this.payType};(0,r.changeCount)(t).then(function(t){if("SUCCESS"==t.data.code){e.tableTitleList=[],e.changeCountArray=t.data.data;for(var a=e.changeCountArray[0].managerCounts,r=0,o=a.length;r<o;r++){var n={prop:"count",label:a[r].manager};e.tableTitleList.push(n)}console.log(e.tableTitleList)}else e.$message.error(t.data.msg)})},getSummaries:function(e){if(e.columns.length<3)return["合计",0];var t=[];t[0]="合计";for(var a=e.data[0].managerCounts.length,r=0;r<a;r++){for(var o=0,n=0,i=e.data.length;n<i;n++)o+=e.data[n].managerCounts[r].count;t[r+1]=o}for(var p=0,s=e.columns.length-1,m=0,l=e.data.length;m<l;m++)p+=100*e.data[m].countMoney;return t[s]=p/100,t}}}}});